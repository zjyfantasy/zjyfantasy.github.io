(self.webpackChunk=self.webpackChunk||[]).push([[951],{8568:function(T,w,h){(function(l,_){T.exports=_(h(17654))})(this,l=>(()=>{"use strict";var _={381:r=>{r.exports=l}},m={};function s(r){var c=m[r];if(c!==void 0)return c.exports;var n=m[r]={exports:{}};return _[r](n,n.exports,s),n.exports}s.d=(r,c)=>{for(var n in c)s.o(c,n)&&!s.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:c[n]})},s.o=(r,c)=>Object.prototype.hasOwnProperty.call(r,c),s.r=r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var u={};return(()=>{s.r(u),s.d(u,{DeviceOrientationControls:()=>y,LocationBased:()=>c,WebcamRenderer:()=>M});class r{constructor(){this.EARTH=4007501668e-2,this.HALF_EARTH=2003750834e-2}project(e,t){return[this.lonToSphMerc(e),this.latToSphMerc(t)]}unproject(e){return[this.sphMercToLon(e[0]),this.sphMercToLat(e[1])]}lonToSphMerc(e){return e/180*this.HALF_EARTH}latToSphMerc(e){return Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180)*this.HALF_EARTH/180}sphMercToLon(e){return e/this.HALF_EARTH*180}sphMercToLat(e){var t=e/this.HALF_EARTH*180;return 180/Math.PI*(2*Math.atan(Math.exp(t*Math.PI/180))-Math.PI/2)}getID(){return"epsg:3857"}}class c{constructor(e,t,i={}){this._scene=e,this._camera=t,this._proj=new r,this._eventHandlers={},this._lastCoords=null,this._gpsMinDistance=0,this._gpsMinAccuracy=1e3,this._watchPositionId=null,this.setGpsOptions(i)}setProjection(e){this._proj=e}setGpsOptions(e={}){e.gpsMinDistance!==void 0&&(this._gpsMinDistance=e.gpsMinDistance),e.gpsMinAccuracy!==void 0&&(this._gpsMinAccuracy=e.gpsMinAccuracy)}startGps(e=0){return this._watchPositionId===null&&(this._watchPositionId=navigator.geolocation.watchPosition(t=>{this._gpsReceived(t)},t=>{this._eventHandlers.gpserror?this._eventHandlers.gpserror(t.code):alert(`GPS error: code ${t.code}`)},{enableHighAccuracy:!0,maximumAge:e}),!0)}stopGps(){return this._watchPositionId!==null&&(navigator.geolocation.clearWatch(this._watchPositionId),this._watchPositionId=null,!0)}fakeGps(e,t,i=null,a=0){i!==null&&this.setElevation(i),this._gpsReceived({coords:{longitude:e,latitude:t,accuracy:a}})}lonLatToWorldCoords(e,t){const i=this._proj.project(e,t);return[i[0],-i[1]]}add(e,t,i,a){this.setWorldPosition(e,t,i,a),this._scene.add(e)}setWorldPosition(e,t,i,a){const d=this.lonLatToWorldCoords(t,i);[e.position.x,e.position.z]=d,a!==void 0&&(e.position.y=a)}setElevation(e){this._camera.position.y=e}on(e,t){this._eventHandlers[e]=t}_gpsReceived(e){let t=Number.MAX_VALUE;e.coords.accuracy<=this._gpsMinAccuracy&&(this._lastCoords===null?this._lastCoords={latitude:e.coords.latitude,longitude:e.coords.longitude}:t=this._haversineDist(this._lastCoords,e.coords),t>=this._gpsMinDistance&&(this._lastCoords.longitude=e.coords.longitude,this._lastCoords.latitude=e.coords.latitude,this.setWorldPosition(this._camera,e.coords.longitude,e.coords.latitude),this._eventHandlers.gpsupdate&&this._eventHandlers.gpsupdate(e,t)))}_haversineDist(e,t){const i=THREE.Math.degToRad(t.longitude-e.longitude),a=THREE.Math.degToRad(t.latitude-e.latitude),d=Math.sin(a/2)*Math.sin(a/2)+Math.cos(THREE.Math.degToRad(e.latitude))*Math.cos(THREE.Math.degToRad(t.latitude))*(Math.sin(i/2)*Math.sin(i/2));return 2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371e3}}var n=s(381);class M{constructor(e,t){let i;this.renderer=e,this.renderer.autoClear=!1,this.sceneWebcam=new n.Scene,t===void 0?(i=document.createElement("video"),i.setAttribute("autoplay",!0),i.setAttribute("playsinline",!0),i.style.display="none",document.body.appendChild(i)):i=document.querySelector(t),this.geom=new n.PlaneBufferGeometry,this.texture=new n.VideoTexture(i),this.material=new n.MeshBasicMaterial({map:this.texture});const a=new n.Mesh(this.geom,this.material);if(this.sceneWebcam.add(a),this.cameraWebcam=new n.OrthographicCamera(-.5,.5,.5,-.5,0,10),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const d={video:{width:1280,height:720,facingMode:"environment"}};navigator.mediaDevices.getUserMedia(d).then(o=>{console.log("using the webcam successfully..."),i.srcObject=o,i.play()}).catch(o=>{setTimeout(()=>{this.createErrorPopup(`Webcam Error
Name: `+o.name+`
Message: `+o.message)},1e3)})}else setTimeout(()=>{this.createErrorPopup("sorry - media devices API not supported")},1e3)}update(){this.renderer.clear(),this.renderer.render(this.sceneWebcam,this.cameraWebcam),this.renderer.clearDepth()}dispose(){this.material.dispose(),this.texture.dispose(),this.geom.dispose()}createErrorPopup(e){if(!document.getElementById("error-popup")){var t=document.createElement("div");t.innerHTML=e,t.setAttribute("id","error-popup"),document.body.appendChild(t)}}}const p=new n.Vector3(0,0,1),v=new n.Euler,E=new n.Quaternion,f=new n.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),b={type:"change"};class y extends n.EventDispatcher{constructor(e){super(),window.isSecureContext===!1&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");const t=this,i=new n.Quaternion;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0,this.orientationChangeEventName="ondeviceorientationabsolute"in window?"deviceorientationabsolute":"deviceorientation";const a=function(o){t.deviceOrientation=o},d=function(){t.screenOrientation=window.orientation||0};this.connect=function(){d(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&(window.addEventListener("orientationchange",d),window.addEventListener(t.orientationChangeEventName,a))}).catch(function(o){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",o)}):(window.addEventListener("orientationchange",d),window.addEventListener(t.orientationChangeEventName,a)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",d),window.removeEventListener(t.orientationChangeEventName,a),t.enabled=!1},this.update=function(){if(t.enabled===!1)return;const o=t.deviceOrientation;if(o){const O=o.alpha?n.Math.degToRad(o.alpha)+t.alphaOffset:0,A=o.beta?n.Math.degToRad(o.beta):0,D=o.gamma?n.Math.degToRad(o.gamma):0,R=t.screenOrientation?n.Math.degToRad(t.screenOrientation):0;(function(P,j,C,x,H){v.set(C,j,-x,"YXZ"),P.setFromEuler(v),P.multiply(f),P.multiply(E.setFromAxisAngle(p,-H))})(t.object.quaternion,O,A,D,R),8*(1-i.dot(t.object.quaternion))>1e-6&&(i.copy(t.object.quaternion),t.dispatchEvent(b))}},this.dispose=function(){t.disconnect()},this.connect()}}})(),u})())},86850:function(T,w,h){"use strict";h.r(w);var l=h(8568),_=h.n(l),m=h(50959),s=h(12077),u=h(11527),r=function(){return(0,m.useEffect)(function(){console.log(l,s);var n=document.getElementById("canvas1"),M=new s.Scene,p=new s.PerspectiveCamera(60,1.33,.1,1e4),v=new s.WebGLRenderer({canvas:n}),E=new l.LocationBased(M,p),f=new l.WebcamRenderer(v),b=new s.BoxGeometry(20,20,20),y=new s.MeshBasicMaterial({color:16711680}),g=new s.Mesh(b,y);E.add(g,-.72,51.051),E.fakeGps(-.72,51.05),requestAnimationFrame(e);function e(){if(n.width!=n.clientWidth||n.height!=n.clientHeight){v.setSize(n.clientWidth,n.clientHeight,!1);var t=n.clientWidth/n.clientHeight;p.aspect=t,p.updateProjectionMatrix()}f.update(),v.render(M,p),requestAnimationFrame(e)}}),(0,u.jsx)("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:(0,u.jsx)("canvas",{id:"canvas1",style:{backgroundColor:"black",width:"100%",height:"100%"}})})};w.default=r}}]);
